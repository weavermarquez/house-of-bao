* Thinking Deeply about Levels

- Ki-Sho-Ten-Ketsu
  : R M ⇀ ⇌ M R
  - Introduce, Develop, Twist, Conclude
  - Ki (起) - Introduction: This is the beginning, where the setting, characters, and initial situation are introduced.
  - Shō (承) - Development: The story develops from the introduction, expanding on the characters, setting, and initial situation.
  - Ten (転) - Twist: An unexpected turn, event, or new element is introduced that changes the direction of the story. This isn't always a dramatic twist but can be a significant change or revelation.
  - Ketsu (結) - Conclusion: The story wraps up, reconciling the twist with the beginning and providing a sense of closure that ties all the elements together. 

** Twists
Clarify
- Things don't always 
Enfold
Cancel
- You can cancel even when angle doesn't match exactly.
- Angles can merge together on the same level.
- Promotion Theorem
- You can cancel angles from nothing.
Create
- You can create angles from nothing.
Disperse
Collect

* Deep Analysis of Level Structure

** The Current State

Looking at your level progression, I see a learning curve that's trying to do too much too fast. Let me map what's actually happening:

*** What Players Actually Learn (Current)
1. *Level 0*: "Here's void" (but void isn't even in the system?)
2. *Level 1*: Clarify (inversion)
3. *Level 2*: Disperse (arrangement intro)
4. *Level 2.5*: Missing - should teach Collect
5. *Level 3*: Create (but from what mental model?)
6. *Level 4*: "Void Sandwich" - too abstract
7. *Level 5*: Cancel (reflection)

The problem: *You're teaching operations before teaching what they operate on*.

** Ki-Sho-Ten-Ketsu Applied to Tutorial Arc

*** Ki (起) - Introduction: What Are These Things?
*Levels 0-2: Building Intuition for Containment*

*Level 0: "The Forest"*
- Start: nothing
- Goal: =() () [] []=
- Actions: Only Enfold Frame, Enfold Mark
- Tutorial: 
  - "This is a space where forms exist."
  - "Tap anywhere to create a Round container: ()"
  - "Tap again to create a Square container: []"
  - "Notice: Nothing becomes something. Order doesn't matter."
  - "These are the building blocks. Let's see what they do."

*Level 0.5: "Nesting"*
- Start: =() [] =
- Goal: =([]) [()]=
- Actions: Enfold only
- Tutorial:
  - "Containers can hold other containers."
  - "Select Round, then Enfold with Square."
  - "Now select Square, then Enfold with Round."
  - "Same pieces, different arrangements. This matters."

*Level 1: "The First Law"*
- Start: =([])=
- Goal: void
- Actions: Only Clarify
- Tutorial:
  - "Round containing Square (or Square containing Round) is special."
  - "They're opposites. They cancel each other."
  - "Tap the outer Round to select the whole form."
  - "Press Clarify."
  - "Opposites annihilate. This is Inversion."

*** Shō (承) - Development: Learning the Operations

*Level 2: "Frames Have Contents"*
- Start: =([() ()])=
- Goal: =() ()=
- Actions: Clarify, Disperse
- Tutorial:
  - "The Square is a Frame. It holds multiple things."
  - "Clarify the Round-Square pair..."
  - "Now the contents are free."
  - "Frames organize. Removing frames releases."

*Level 2.5: "Gathering"*
- Start: =([()]) ([()])=
- Goal: =([ () () ])=
- Actions: Only Collect
- Tutorial:
  - "These two forms share a pattern: Round-Frame-with-one-Round."
  - "Select both outer Rounds."
  - "Press Collect."
  - "Shared context merges into one Frame."
  - "This is Arrangement - gathering similar forms."

*Level 3: "Making Pairs"*
- Start: =()=
- Goal: =() <()>=
- Actions: Only Create (with template)
- Tutorial:
  - "Select the Round."
  - "Press Create."
  - "The Angle bracket <> marks a reflection."
  - "Every form has a reflection. They're like mirrors."

*Level 4: "Pairs Vanish"*
- Start: =() <()>=
- Goal: void
- Actions: Only Cancel
- Tutorial:
  - "A form and its reflection are opposites."
  - "Select both."
  - "Press Cancel."
  - "They annihilate. This is Reflection."

*** Ten (転) - Twist: Combining Laws

*Level 5: "The Void Equivalence"*
- Start: =([()]) ([()])= (looks complex!)
- Goal: void
- Tutorial:
  - "This looks complicated, but..."
  - "Each Round contains Frame-Round, which is ([])."
  - "Clarify one: ([()]) → () → void? No, it's just ()."
  - "Wait - both Clarify to (). Now you have () ()."
  - "Create reflections: () <()> () <()>"
  - "Cancel each pair."
  - "Complexity collapses. Many paths to void."

*Level 5.5: "Frames Are Fungible"*
- Start: =() () [] []=
- Goal: =([() ()]) [(() ())]= (or the reverse)
- Actions: Enfold Frame, Enfold Mark
- Tutorial:
  - "Select the two Rounds."
  - "Enfold Frame: =([() ()])="
  - "Or Enfold Mark: =[(() ())]="
  - "Different boundaries, same meaning - until you add more."
  - "Frames organize. Marks organize differently."

*Level 6: "Double Arrangement"*
- Start: =([() ()]) ([() ()])=
- Goal: =([ ([]) ([]) ])=
- Actions: Clarify, Collect, Enfold
- Tutorial:
  - "Two identical forms: =([() ()])= each."
  - "Collect them: =([ ([() ()]) ([() ()]) ])="
  - "Hmm, that's not the goal..."
  - "Wait - the goal has =([])= inside. Where does that come from?"
  - "Clarify the inner pairs! =() ()= → =([])= when enfolded."
  - "This is composition: operations build on operations."

*** Ketsu (結) - Conclusion: The System Reveals Itself

*Level 7: "Context Is Shared"*
- Start: =A ([B C])=
- Goal: =([A B]) ([A C])=
- Actions: Disperse only
- Tutorial:
  - "Now we introduce atoms: A, B, C."
  - "The Round contains A and a Frame with B and C."
  - "Disperse: A gets copied to each Frame sibling."
  - "Context flows into Frames. This is how distribution works."

*Level 7.5: "Collecting Context"*
- Start: =([A B]) ([A C])=
- Goal: =A ([B C])=
- Actions: Collect only
- Tutorial:
  - "Reverse the last level."
  - "Notice: Both Rounds share A."
  - "Collect pulls shared context out."
  - "Distribution and collection are inverses."

*Level 8: "The First Real Puzzle"*
- Start: =(A []) (A [()])=
- Goal: =(A [()])=
- Actions: All enabled
- Tutorial (hint only):
  - "Hint: =void + A = A="
  - "One of these Rounds has an empty Frame..."
  - "What happens to empty things?"

** Why This Works

*** Cognitive Load Management
- *Levels 0-1*: One action at a time
- *Levels 2-4*: Introduce each axiom separately
- *Levels 5-6*: Combine two operations
- *Levels 7+*: Full system available

*** Discovery Over Instruction
- *Level 0*: Players create forms physically (enfold only)
- *Level 1*: Players destroy forms (clarify only)
- *Level 5*: Players discover void-equivalence themselves
- *Level 8*: First "real" puzzle with minimal hint

*** Narrative Arc
1. *Ki*: "What are these containers?"
2. *Shō*: "Oh, I can transform them with these three laws."
3. *Ten*: "Wait, these laws combine in unexpected ways!"
4. *Ketsu*: "I'm starting to see patterns... this is math, but different."

** Implementation Notes

*** Tutorial Text Principles
- *Show, don't tell*: "Press this" > "This operation does X because Y"
- *One sentence at a time*: Each popup = one action or concept
- *Progressive disclosure*: Only explain when relevant
- *Celebrate discovery*: "Wait..." / "Huh!" moments are good

*** Action Restrictions
- *Allowlist, not blocklist*: Specify =allowedActions: ['clarify']= not =blockedActions: [...]=
- *Teach by constraint*: Restricting actions forces exploration of the one allowed action
- *Gradual unlock*: Each level introduces 1 new action until all are available

*** Visual Design
- *Highlight changes*: Animate the transformation, don't just snap
- *Show causality*: "This became that because..."
- *Color code operations*: Each axiom gets a color family
  - Inversion: Purple (annihilation)
  - Arrangement: Green (movement)
  - Reflection: Orange (creation)

** Next Steps

1. *Implement Level 0-8 with this structure*
2. *Playtest specifically for "aha moments"*
   - Does Level 5 feel like a revelation?
   - Does Level 7 make atoms click?
3. *Build Level 9-15* following the same Ki-Sho-Ten-Ketsu at a higher level:
   - Ki: Here's arithmetic (2+2, 3+1)
   - Shō: Here's how to manipulate it
   - Ten: Wait, this is more than arithmetic...
   - Ketsu: I can solve any problem

Should I detail out Levels 9-15 now, or do you want to iterate on 0-8 first?


* Tutorial Framework
Phase 1. sounds all good. Can you provide info to delegate that out?

* Phase 2. Levels
- We should not be afraid to rearrange the levels numbers, but maybe it's useful to keep it consistent just for easier tracking andn comparisons between playtests.
- Level 0 is kind of ironic given that there is no 0 in the system other than /void/. Anyways.
  - Some instructions are good.
  - fyi, selected forms have their outer strokes turn /red/.
  - I think players should do /something/ instead of just reading, fam.
  - To be on point, it should actually be to /create/ some simple void-equivalent forms. Maybe actually, yeah, get the player to a goal state of, not nothing, but rather, a somewhat simple forest of empty Frames and empty Marks.
    - start state: nothing
    - Goal state: one frame, two marks at the toplevel
    - this also should show that nothignness is a valid state, and that order does not matter. 
    - disable all actions except enfold frame and enfold mark. >:)
  - give me feedback: is this too hard? the solution is ultimately just pressing three buttons (and maybe undo/reset if they overshoot, which... hm, idk, mayb a good thing?)
  - this is where we introduce /enfold/ and /void/

    This needs changing
    #+begin_quote
  1. level_start: "Welcome! This is a form - a container. Tap it to select."
  2. first_selection: "Great! Selected forms glow blue. Now look at the actions below."
  3. button_hover (any button): "These buttons transform your selection. Hover to see what they do."
  4. Message: "Notice: most actions are gray (disabled). Only valid moves are enabled!"
  5. Final: "This form is already at the goal. Try the next level!"
    #+end_quote

- level 1: first unwrap
  - disable all actions except Clarify
  - I like the presented tutorial steps.
  - this is where we introduce /clarify/
  - add tutorial text. 
    #+begin_quote
  1. level_start: "Round containing Square containing Round. Your goal: unwrap to reveal just Round."
  2. After first selection: "Clarify removes paired Round-Square wrappers. Try it!"
  3. On success: "Nice! Round-Square cancels to nothing. This is Inversion."
    #+end_quote

- level 2:
  - tut: "what we see is a 'frame' (note: maybe show bounding-box svg?) with two rounds as its *content*."
    - I liked your description for 2.5, I trust you'll do fine making more tut text here.
  - this is where we introduce /disperse/
  - I think this is what needs some tutorial steps here.
    
- level 2.5: the missing collect tutorial :)
  - following from 2, this should not be (A[B])(A[C]) but rather it should simply be ([B])([C]) while Clarify is /disabled/. we can introduce "context" in level 7.
  - definitely needs tutorial text, this is where we introduce /collect/
    Please modify to a version without context.
    #+begin_quote

    #+end_quote

- Level 3 presents too little information about what or why we are able to create an empty <> from nothing. We should introduce the idea of 
  - start state: round()
  - goal state: round(), round(), angle(round()), angle()
  - the player must press create twice: once with a template selected and once while nothing selected.
  - only /create/ action enabled.
  - probably add tutorials since this is where we introduce angle brackets and /create/
    
- Level 4: I like the name Void Sandwich but this level layout conveys too little information.
  - I think this needs to be a supercharged version of Level 1.
    - start form: a somewhat more complicated forest of void-equivalent forms. Not merely a trivial collection but something that actually /looks/ verging on complex.
      Of course, it is a well balanced stack of rounds and squares which clarify to nothing.
    - goal form: void
      
- level 5: Void Collapse is okay, but I think it should be a tad more complex. Let's start out with a slight variation of the current start form.
  - start form: round(), angle(round(), round(), angle(round()))
  - goal form: void
  - only /cancel/ action enabled
  - probably add tutorials since this is where we introduce /cancel/
  
- level 5.1: (your proposal):
  - we need a simple intro to the frame vs. mark distinction.
  - empty Frames and Marks are interchangable but we don't have a way to make that fungible yet. So we might as well teach this.
  - starting form: oooo
  - goal: ([o o]) [(o o)]
  - your tutorial steps
    IDK how we're going to program multiple goals TBH. Maybe we should just keep it be have one and the other.
#+begin_quote
    1. level_start: "Two separate things. Let's wrap them together."
    2. After selecting both: "You can choose Enfold Frame (○□) or Enfold Mark (□○)."
    3. After first enfold: "They look different but mean the same thing until you add more!"
    4. Hint: "Try both and see - either satisfies the goal."

#+end_quote    
- level 5.5:
  - creating a frame from a collection
  - starting form: ([oo] o) ([oo] o) 
  - goal form: ([oooo] o)

- [X] Level 6:
  - this is where we introduce /atoms/ or /variables/, but we haven't done anything with that yet. presently, this is functionally identical to level 01 until we improve on the clarification.
  - Maybe we use this level to start combining axioms? Nothing crazy, just the basic ones Inversion and Reflection.
  - start: ([ [(A)] ([<A>]) ])  B
  - goal:  [( ([ ([B]) [(B)] ]) <B> )]   
    
- level 7
  - there are so many possible variations of this level to explore based on both the context as well as the contents. I would have to provide more detail about that but I can't right now. 
  - this is where we introduce the idea of /context/ of a frame. let's just keep it straightforward here.
    - [ ] this will require a tutorial
  - start form: keep
  - goal form: keep
    
    
- [X] level 7.1 parent 1
  - I think we need to add the idea of adding a mark /inside/ a frame to separate out a collection of items into separate containers, and then start to clue in on collecting on those frames. This is also a crucial step that was not covered.
  - starting form: o o o [] [] [] 
  - goal form: ([o []][o])([o []][o])([o []][o])
    - this will require players to enfold with a frame, mark. they will see the pattern later to be able to collect them.
  - this is where we introduce the idea of /selecting a parent/ of a frame.
  - [ ] we will need tutorial text for this.
    #+begin_quote
  1. level_start: "Time to learn parent selection!"
  2. "See the space around the square? Right-click (or long-press) to select it as parent."
  3. After parent selected: "Now select the contents inside the square."
  4. After both selected: "Disperse splits square contents when you specify the parent!"
    #+end_quote

- level 7.2 parent 2
  - start form: round(atom(A)), round(square())
  - goal form: round(atom(A)), square(round( atom(A), angle(atom(A)) ))
  - this is where we introduce the idea of /selecting a parent/ for the target location of the /select/ and /enfold/ actions.
  - we may need tutorial text to point out that the /create/ action's parent selection can be /anywhere/, as opposed to /enfold/ which is locally bound if it is wrapping something and can be anywhere if it is wrapping /void/ (aka being created out of nowhere and having no children)
    
  
- level 7.2 combine Arrangement with other axioms
  - collect after enfolding to match
  - ran out of steam. will have to design later.

- level 7.5 combine Arrangement with other axioms
  - collect after creating to match
  - ran out of steam. will have to design later.

- level 7.9 a sneak-peek of a crucial step in the Dominion Theorem
  - starting form: round(atom(A), square()), round(atom(A), square(round()))
  - goal form: round(atom(A),square(round()))
  - sadly, i havent' implemented the other direction yet.
  - this may require a /hint/ about void + A = A, or such.

Let's go with 1) Option A. 2) I would like to remove certain levels. 



-----

as for levels 8 onwards... uhhh, we'll deal with that later. hopefully the more fleshed out tutorial levels help with the difficulty spike.


* Tutorial Onboarding Design

Option 1: Tutorial Prompts on gameplay when relevant. No separate tutorial mode.
- The biggest pain point for completely new players is that they have no clue how to even /read/ the gamestate or even the UI.
  - I think there's no way around this at the moment other than explicit instruction connecting the idea of containment to the way the nodes are displayed in the play area.
  - I think the bounding box dialect is uniquely strong in this regard for visually enclosing one shape in the other.
- I also think there's no way around the fact that new players don't know that they can select both nodes as well as the spaces between them, and what the hell that means.
  Or that "nothingness" is semantically notable.
  I think we want to keep these overlays as minimal as possible, I agree.

  I don't think such modals should be /one time only/ - they should be tied to specific action introduction levels. We don't want to presume a players' comfort and we want to help them re-orient themselves by coming back to intro levels if they feel lost later.
  

Option 2: Practice Levels
- Frankly, I think we need a /lot/ more practice levels in any case. But I can't expect you to design them, I understand.
- I'm torn between introducing the connection between arithmetic and this system earlier or later.
  - Points for Earlier: establishes motivation for even understranding what the hell the containers are. Or what this is "supposed" to be. I know that I wanted explanations about that ASAP and I have noticed that with several playtesters.
    - We can easily draw inspiration for a gradation of levels by simply drawing from the k-12 math curriculum, especially the early grades. There should be workbooks for introducing new concepts that are already well designed to gently introduce concepts while exploring the nuances of the conventional arithmetic system. However, some of these nuances will be lost in translation to james algebra because JA already simplifies and clears a lot of unnecessary complications up.  
  - Points for Later: playing around with the rules in themselves should be fun in order to determine whether this system is fertile ground for a /puzzle game/ and not just a 'fake-fun' way of teaching math. Puzzles are going to have to come not just from its interpretation to contemporary math but also in the nuances of boundary based / iconic systems. this means embracing, exploring, and highlighting concepts like void-equivalence (e.g. by featuring a set of levels for the Inversion axiom that literally just involves cleaning trees up with Clarify, or /creating/ elaborate structures with Enfold)
    - There are many nuances /especially/ to Arrangement that can /not/ be explored if players are stuck in the mindset of solely interpreting James Algebra as a notation for conventional math. From the book:
      #+begin_quote
If reducing every arbitrary form within an axiomatic
system is easy, then the system is trivial. Useful systems
must include difficult reductions. Descriptively powerful
transformation processes are necessarily complex. The
complexity associated with Arrangement is that the most
effective direction of application is unclear. There is not
a consistently preferred direction that leads to a minimal
form, rather direction of application depends upon con-
text. Arrangement is the only James axiom that entails
complexity, a feature that leads to very efficient trans-
formation sequences. But having three different types of
boundaries potentially increases the risk of undesirable
features such as the lack of a unique normal form. There
is even the risk of contradictory results.8 For the James
algebra, we will come across a quite interesting com-
plexity: the system itself is very well behaved, but the
interpretation can step outside of the domain of numbers,
as is the case of zero and infinity.
      #+end_quote
    - The current implementation of Reflection is largely incomplete until we incorporate more functionality for variable/atom hydration. Right now, we rely on the user selecting from forms directly visible on the screen as the template, but that is just a temporary limitation of the system and not an actual property of the axiom.
  
Option 3:
I think good naming is always important. But we do not have a solver.
Hmm. I do think a hint system is likely necessary.
We just received back the hover previews, and it is /glorious/. We still have to do more work to make the actions eligible on a broader selection of actions that they really should have, but this does a /ton/ to help. 

Option 4:
Duh, hybrid approach. I am wondering if we will need to further consider the plan given the details I have provided here.


Tutorial Framework:
A level contains...
- a leveldefinition
  - Name
  - Start Form
  - Goal Form
  - optional Axiom Restrictions (maybe make this broader -- perhaps /specific action/ restrictions?) :: currently implemented as an allowlist instead
  - optional tutorial steps
  - isintrolevel :: is this necessary? either it contains tutorial info or not, right? doesn't really matter if it's an intro level.
    
- Tutorial Steps.
  - id, trigger, position, title, message, dismissonaction, requiredaction all sound good.
  - targetElement may be a bit difficult, but we could reuse the 'label' field since they are unused in non-atom nodes?
  
I think tutorialstate should not be cleared. This is a prototype right now.






